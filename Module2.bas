Public Sub SITS_Separate_File_MiddleEast(CountryCode As String, ContactName As String, EmailAddress As String)'   MIDDLE EAST !!!SPECIAL CASE, DIFFERENT VARIABLES AND FILTERING!!!        Dim Countries() As Variant    Countries = Array("Bahrain", "Oman", "Qatar", "Saudi Arabia", "United Arab Emirates")    '   You need to have the WorldWide Deal Tracker already open, edit the file name below VVVVV    Set WWfile = Workbooks("WW_SITS_Deal_Tracker_Jun24.xlsx")    WWfilename = "WW_SITS_Deal_Tracker_Jun24.xlsx"    DefaultName = "_SITS_Deal_Tracker_Jun24.xlsx"    Set WWsheet = WWfile.Sheets("Deals_incl_since_05-2017")    WWsheet.Range("D1").AutoFilter Field:=4, Criteria1:=Countries, Operator:=xlFilterValues'   Create a new workbook and copy the filtered data after 2017    Set newWb = Workbooks.Add    Set newWs = newWb.Sheets(1)    newWs.Name = WWsheet.Name    WWsheet.UsedRange.SpecialCells(xlCellTypeVisible).Copy newWs.Range("A1")    '   Copy row height and column width, and set the data rows to height 16    newWs.Rows(1).RowHeight = WWsheet.Rows(1).RowHeight    newWs.UsedRange.Rows(2 & ":" & newWs.UsedRange.Rows.Count).RowHeight = 16    For col_index = 1 To 20 'Copy columns width        newWs.Columns(col_index).ColumnWidth = WWsheet.Columns(col_index).ColumnWidth    Next col_index'   Clean up    WWsheet.Columns("U:X").Delete ' For some reason the process creates new, empty columns. This simply deletes them.    WWsheet.AutoFilterMode = False    newWs.Range("A1:T1").AutoFilter    newWs.UsedRange.Borders.LineStyle = xlContinuous    newWs.Select    ActiveWindow.DisplayGridlines = False    '   Copy the filtered data before 2017    Set WWsheet = WWfile.Sheets("Deals_incl_before_05-2017")    WWsheet.Range("F1").AutoFilter Field:=6, Criteria1:=Countries, Operator:=xlFilterValues    Set newWs = newWb.Sheets.Add    newWs.Name = WWsheet.Name    WWsheet.UsedRange.SpecialCells(xlCellTypeVisible).Copy newWs.Range("A1")    '   Copy row height and column width, and set the data rows to height 16    newWs.Rows(1).RowHeight = WWsheet.Rows(1).RowHeight    newWs.UsedRange.Rows(2 & ":" & newWs.UsedRange.Rows.Count).RowHeight = 16    For col_index2 = 1 To 29        newWs.Columns(col_index2).ColumnWidth = WWsheet.Columns(col_index2).ColumnWidth    Next col_index2'   Clean up    WWsheet.Columns("AD:AF").Delete ' For some reason the process creates new, empty columns. This simply deletes them.    WWsheet.AutoFilterMode = False    newWs.Range("A1:AC1").AutoFilter    newWs.UsedRange.Borders.LineStyle = xlContinuous    newWs.Select    ActiveWindow.DisplayGridlines = False        '   Copy the other sheets    WWfile.Sheets(Array("INDEX", "Definitions", "Generic Segmentation", "About PAC")).Copy Before:=newWb.Sheets(1)    Sheets("Deals_incl_since_05-2017").Move After:=Worksheets(Worksheets.Count)    Sheets("Deals_incl_before_05-2017").Move After:=Worksheets(Worksheets.Count)    Sheets("Definitions").Move After:=Worksheets(Worksheets.Count)    Sheets("Generic Segmentation").Move After:=Worksheets(Worksheets.Count)    Sheets("About PAC").Move After:=Worksheets(Worksheets.Count)        '   Update the information in INDEX    Set Index = newWb.Sheets("INDEX")    Index.Range("C4").Value = "The Middle East by countries"    Index.Range("C9").Value = ContactName    Index.Hyperlinks.Add Anchor:=Index.Range("C9"), Address:=EmailAddress, TextToDisplay:=ContactName    Index.Range("C9").Font.Size = 12    Index.Range("C9").Font.Name = "Lato"        Index.Activate    '   Save the file'   newWb.SaveAs FileName:=Path & CountryCode & DefaultName, FileFormat:=xlsx, CreateBackup:=False    newWb.SaveAs FileName:=Application.DefaultFilePath & CountryCode & DefaultName    newWb.Close SaveChanges:=False    End Sub